<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Holiday Settings</title>
</head>
<body>
<script>
// 祝日一覧を生成
function getJapaneseHolidays(year) {
  let holidays = [];

  // 固定祝日
  const fixed = [
    ["01-01", "元日"],
    ["02-11", "建国記念の日"],
    ["02-23", "天皇誕生日"],
    ["04-29", "昭和の日"],
    ["05-03", "憲法記念日"],
    ["05-04", "みどりの日"],
    ["05-05", "こどもの日"],
    ["08-11", "山の日"],
    ["11-03", "文化の日"],
    ["11-23", "勤労感謝の日"]
  ];

  // 固定祝日を追加
  fixed.forEach(([md, name]) => {
    holidays.push({ date: `${year}-${md}`, name });
  });

  // ハッピーマンデー制度
  const happyMondays = [
    [1, 2, "成人の日"], // 1月第2月曜
    [7, 3, "海の日"],   // 7月第3月曜
    [9, 3, "敬老の日"], // 9月第3月曜
    [10, 2, "スポーツの日"] // 10月第2月曜
  ];

  happyMondays.forEach(([month, nth, name]) => {
    const date = getNthMonday(year, month, nth);
    holidays.push({ date, name });
  });

  // 春分・秋分の日（簡易計算）
  holidays.push({ date: `${year}-${calcVernalEquinox(year)}`, name: "春分の日" });
  holidays.push({ date: `${year}-${calcAutumnEquinox(year)}`, name: "秋分の日" });

  // 日付順に並べ替え
  holidays.sort((a, b) => new Date(a.date) - new Date(b.date));

  // 振替休日を追加
  holidays = addSubstituteHolidays(holidays);

  // 国民の休日を追加
  holidays = addNationalHolidays(holidays);

  return holidays;
}

// n番目の月曜日を求める
function getNthMonday(year, month, nth) {
  const firstDay = new Date(year, month - 1, 1);
  const dayOfWeek = firstDay.getDay();
  const offset = (8 - dayOfWeek) % 7;
  const day = 1 + offset + (nth - 1) * 7;
  return `${year}-${String(month).padStart(2, "0")}-${String(day).padStart(2, "0")}`;
}

// 春分の日計算
function calcVernalEquinox(y) {
  let day = 20.8431 + 0.242194 * (y - 1980) - Math.floor((y - 1980) / 4);
  return `03-${String(Math.floor(day)).padStart(2, "0")}`;
}

// 秋分の日計算
function calcAutumnEquinox(y) {
  let day = 23.2488 + 0.242194 * (y - 1980) - Math.floor((y - 1980) / 4);
  return `09-${String(Math.floor(day)).padStart(2, "0")}`;
}

// 振替休日追加（日曜に祝日があった場合、次の平日）
function addSubstituteHolidays(holidays) {
  const result = [...holidays];
  holidays.forEach(h => {
    const date = new Date(h.date);
    if (date.getDay() === 0) { // 日曜
      let substitute = new Date(date);
      substitute.setDate(date.getDate() + 1);
      while (result.find(r => r.date === formatDate(substitute))) {
        substitute.setDate(substitute.getDate() + 1);
      }
      result.push({ date: formatDate(substitute), name: "振替休日" });
    }
  });
  result.sort((a, b) => new Date(a.date) - new Date(b.date));
  return result;
}

// 国民の休日追加（祝日に挟まれた平日）
function addNationalHolidays(holidays) {
  const result = [...holidays];
  for (let i = 0; i < holidays.length - 1; i++) {
    const d1 = new Date(holidays[i].date);
    const d2 = new Date(holidays[i + 1].date);
    if ((d2 - d1) / (1000 * 60 * 60 * 24) === 2) {
      const mid = new Date(d1);
      mid.setDate(mid.getDate() + 1);
      if (mid.getDay() !== 0 && mid.getDay() !== 6) { // 平日
        result.push({ date: formatDate(mid), name: "国民の休日" });
      }
    }
  }
  result.sort((a, b) => new Date(a.date) - new Date(b.date));
  return result;
}

// 日付を YYYY-MM-DD 形式に
function formatDate(d) {
  return `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, "0")}-${String(d.getDate()).padStart(2, "0")}`;
}

// 🎯 2025年6月～2035年12月の祝日リスト作成
const allHolidays = [];
for (let y = 2025; y <= 2075; y++) {
  const startMonth = (y === 2025) ? 6 : 1;
  const endMonth = (y === 2035) ? 12 : 12;
  getJapaneseHolidays(y).forEach(h => {
    const month = parseInt(h.date.split("-")[1], 10);
    if (month >= startMonth && month <= endMonth) {
      allHolidays.push(h);
    }
  });
}

// JSONとして出力（fetchで読み込む想定）
document.write(`<pre>${JSON.stringify({ holidays: allHolidays }, null, 2)}</pre>`);

</script>
</body>
</html>
